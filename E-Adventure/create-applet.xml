<?xml version="1.0" encoding="UTF-8"?>

<project basedir="." default="generate" name="build.eAdventureApplet">
	<description>
    This ant build file is used to build the project as a jar file.
	</description>

	<target name="cleanup">
		<delete file="web/eAdventure_S.jar" />
		<delete file="web/eAdventure.jar" />
		<delete file="web/temp/**"/>
	</target>

	<target name="jar" description="generate the eadventure applet">
		<delete file="web/eAdventure_temp.jar" />
		<copy todir="web/temp">
			<fileset dir=".">
				<!--<include name="eadventure.dtd" />
				<include name="descriptor.dtd" />
				<include name="adaptation.dtd" />
				<include name="assessment.dtd" />-->
				
				<include name="gui/**" />
				<include name="lanengine/en_EN.xml" />
				<include name="java.policy.applet" />
			</fileset>
			<fileset dir="bin">
				<include name="**" />
			</fileset>
		</copy>
		<jar compress="true" destfile="web/eAdventure_S.jar">
			<fileset dir="web/temp">
				<exclude name="CVS/**" />
				<include name="**" />
			</fileset>
			<zipfileset src="jars/truezip-6.jar" />
			<zipfileset src="jars/tritonus_share.jar" />
			<zipfileset src="jars/plugin.jar" />
			<zipfileset src="jars/mp3spi1.9.4.jar" />
			<zipfileset src="jars/jmf.jar" />
			<zipfileset src="jars/jl1.0.jar" />
			<zipfileset src="jars/jffmpeg-1.1.0.jar" />
			<zipfileset src="jars/cmu_time_awb.jar" />
			<zipfileset src="jars/cmu_us_kal.jar"/>
			<zipfileset src="jars/cmudict04.jar" />
			<zipfileset src="jars/cmulex.jar" />
			<zipfileset src="jars/cmutimelex.jar" />
			<zipfileset src="jars/en_us.jar" />
			<zipfileset src="jars/freetts.jar" />
			
			<manifest>
				<attribute name="Main-Class" value="es.eucm.eadventure.engine.EAdventureStandalone" />
			</manifest>

		</jar>

		<copy todir="web/temp">
			<fileset dir=".">
				<!--<include name="eadventure.dtd" />
				<include name="descriptor.dtd" />
				<include name="adaptation.dtd" />
				<include name="assessment.dtd" />-->
				
				<include name="gui/**" />
				<include name="en_EN.xml" />
				<include name="java.policy.applet" />
			</fileset>
			<fileset dir="bin">
				<include name="**" />
			</fileset>
		</copy>
		<jar compress="true" destfile="web/eAdventure.jar">
			<fileset dir="web/temp">
				<exclude name="CVS/**" />
				<include name="**" />
			</fileset>
			<zipfileset src="jars/truezip-6.jar" />
			<zipfileset src="jars/tritonus_share.jar" />
			<zipfileset src="jars/plugin.jar" />
			<zipfileset src="jars/mp3spi1.9.4.jar" />
			<zipfileset src="jars/jmf.jar" />
			<zipfileset src="jars/jl1.0.jar" />
			<zipfileset src="jars/jffmpeg-1.1.0.jar" />
			<zipfileset src="jars/cmu_time_awb.jar" />
			<zipfileset src="jars/cmu_us_kal.jar"/>
			<zipfileset src="jars/cmudict04.jar" />
			<zipfileset src="jars/cmulex.jar" />
			<zipfileset src="jars/cmutimelex.jar" />
			<zipfileset src="jars/en_us.jar" />
			<zipfileset src="jars/freetts.jar" />
			
			<manifest>
				<attribute name="Main-Class" value="es.eucm.eadventure.engine.EAdventureApplet" />
			</manifest>

		</jar>

		<zip destfile="web/eAdventure_temp.jar"> 
		        <zipfileset src="web/eAdventure.jar"> 
		                <exclude name="**/MANIFEST.MF" /> 
		        </zipfileset> 
		</zip>
		
	</target>
	
	<target name="sign">
		
		<exec executable="cmd" inputstring ="mypass">
			<arg value="/c"/>
			<arg value="C:/Datos/workspace/EAdventure2D/web/signapplet.bat"/>
			<arg value="-p"/>
			
		</exec>
		
	</target>
	
	<target name="launchweb">
		<exec executable ="C:\Program Files (x86)\Internet Explorer\iexplore.exe">
			<arg value="C:\Datos\workspace\EAdventure2D\web\eGame.html"/>
			
		</exec>
	</target>
	
	<!--<target name="sign" description="sign the eadventure applet">
		<signjar jar="web/eAdventure.jar" alias="TestCert" storepass="mypass"/>
	</target>-->
	

	<target name="generate" depends="cleanup,jar,cleanup" description="Clean and Generate" />
</project>
